# 1.4 Оптимальное обнаружение сигналов

## Априорные вероятности в задаче обнаружения
$P(H_0)$ - вероятность отсутствия сигнала в смеси.

$P(H_1)$ - вероятность наличия сигнала в смеси.

---

## Критерий Байеса (среднего риска) и Неймана-Пирсона в задаче обнаружения
Критерий Байеса - минимизация среднего риска. Критерий Неймана-Пирсона - максимизация D при фиксированной F.

Средний риск определяется выражением
$$ \tag{1.4.2, стр. 71}
    r = r_{01}P(A_0H_1) + r_{10}P(A_1H_0)
$$
Представив его в виде $r = r_{01}P(H_1)\overline{D} + r_{10}P(H_0)F$ и введя весовой коэффициент $a_0 = r_{10}P(H_0)/r_{01}P(H_1)$ преобразуем его к виду
$$ \tag{1.4.4, стр. 71}
    r = r_{01}P(H_1)(\overline{D} + a_0F) = r_{01}P(H_1)(1 - (D - a_0F))
$$
т.к. $r_{01}P(H_1) > 0$ критерий минимума среднего риска определяется выражением $D - a_0F \to \max$, а критерий Неймана-Пирсона выражением $D \to \max|_{F \le F_0}$.

Для критерия Байеса необходимо знать априорные вероятности $P(H_0)$ и $P(H_1)$.

---

## Решающее правило в условии белого гауссова шума
Отношение и логарифм отношения правдоподобия определяются выражениями
$$ \tag{1, стр. 72 - 73}
    \Lambda = \frac{W[z(t)|H_1]}{W[n(t)|H_0]} = \frac{W[z(t)]}{W[n(t)]}, L = lg\Lambda
$$
Подставляя в $(1)$ выражения $(1.3.10)$ и $(1.3.11)$ получаем решающее правило
$$ \tag{1.4.5, стр. 73}
    Y = \intop_0^{\Delta T}z(t)S(t)dt \gtrless z_0
$$
$Y > z_0 \to H_1$, $Y < z_0 \to H_0$. Реализация данного правила включает в себя умножитель, интегратор и пороговое устройство.

---

## Решающее правило при окрашенном гауссовом шуме
Подставляя $(1.3.12)$ и $(1.3.13)$ в $(1)$ получаем
$$ \tag{1.4.6, стр. 74}
    Y = \intop_0^{\Delta T}\intop_0^{\Delta T}z(t_1)R_n^{-1}(t_1,t_2)S(t_2)dt_1dt_2 \gtrless z_0
$$
Введем функция $S'(t) = \intop_0^{\Delta T}R_n^{-1}(t, t_1)dt_1$, тогда
$$ \tag{1.4.8, стр. 74}
    Y = \intop_0^{\Delta T}z(t)S'(t)dt \gtrless z_0
$$
т.е. структура как в случае белого шума, но с $S'(t)$ вместо $S(t)$.

---

## Реализация решающего правила
1. Коррелятор $Y[z(t)S(t)]$, включает в себя умножитель и интегратор. На вход умножителя поступает входной процесс $z(t)$ и опорный сигнал $S_{оп}(t)$.
2. Согласованный фильтр с импульсной характеристикой $g(t-\tau)=S_{оп}(\tau)$. Корреляционный интеграл вычисляется как отклик согласованного фильтра $\intop_0^{\Delta T}z(\tau)g(\Delta T - \tau)d\tau$. Опорный сигнал не требуется, т.к. он заложен в импульсной характеристике.

Коррелятор формирует конкретное значение корреляционного интеграла, которое зависит от задержки между $z(t)$ и $S_{оп}(t)$, т.к. он не инвариантен ко времени прихода сигнала.

Согласованный фильтр инвариантен ко времени прихода сигнала и формирует корреляционный интеграл как функцию времени. Важно выбрать отсчет момента времени, чтобы он совпадал с моментом максимального значения корреляционного интеграла.

---

## Выбеливание шума
Сигнал пропускается через выбеливающий фильтр $|K(f)|=N^{-1/2}(f)$, после которого  СПМ шума становится постоянной $N(f)|K(f)|^2 = const$. Сигнал будет иметь частотный спектр $S(f)K(f)$, и в качестве опорного сигнала нужно использовать исходный сигнал, пропущенный через выбеливающий фильтр.

---

## Характеристика обнаружения
Зависимость $D = f(q)|_{F = \text{const}}$ вероятности правильного обнаружения от отношения сигнал/шум на входе РТС при заданной вероятности ложной тревоги.

---

## Вероятность обнаружения и ложной тревоги в белом гауссовом шуме
При решающей статистике $Y[z(t)S(t)]$
$$ \tag{1.4.11, стр. 79}
    W_0(Y)=\frac{1}{\sqrt{2\pi}\sigma_Y}exp\left(-\frac{Y^2}{2\sigma_Y^2}\right)
$$
$$ \tag{1.4.12, стр. 79}
    W_1(Y)=\frac{1}{\sqrt{2\pi}\sigma_Y}exp\left(-\frac{(Y - m_Y)^2}{2\sigma_Y^2}\right)
$$
где $m_Y = E_c$, $\sigma_Y = \sqrt{N_0E_c}$. Тогда
$$ \tag{1.4.13, стр. 80}
    F = 1 - Ф\left( \frac{z_0}{E_c}\sqrt{\frac{E_c}{N_0}} \right)
$$
$$ \tag{1.4.14, стр. 80}
    D = Ф\left( \sqrt{\frac{E_c}{N_0}} - \frac{z_0}{E_c}\sqrt{\frac{E_c}{N_0}} \right) = Ф\left[\sqrt{q} - Ф^{-1}(1 - F)\right]
$$
где $Ф(y) = \frac{1}{\sqrt{2\pi}}\intop_{-\infty}^y exp\left(-y_1^2/2\right)dy_1$ - интеграл вероятностей.

Заданная вероятность ложной тревоги обеспечивается выбором порога $z_0 = E_c\sqrt{\frac{N_0}{E_c}}Ф^{-1}(1 - F)$.

---

## Обнаружение сигнала со случайной начальной фазой
Решающее правило имеет вид
$$ \tag{1.4.16, стр. 83}
    Y = \sqrt{\left(\intop_0^{\Delta T}z(t)s_1(t)\right)^2 + \left(\intop_0^{\Delta T}z(t)s_2(t)\right)^2} \gtrless z_0
$$
Данная схема может быть реализована либо через два коррелятора, либо через один согласованный фильтр (чья импульсная характеристика соответствует обнаруживаемому сигналу с точностью до неизвестной начальной фазы), после которого стоит амплитудный детектор (выделяющий огибающую). Т.е. согласованный фильтр согласован с любой случайной начальной фазой.

---

## Вероятности обнаружения и ложной тревоги для сигнала со случайной начальной фазой
Огибающая корреляционного интеграла при отсутствии сигнала распределена по закону Релея.
$$ \tag{1.4.18, стр. 86}
    W_0(Y) = \frac{Y}{\sigma_Y^2}\exp\left(-\frac{Y^2}{2\sigma_Y^2}\right)
$$
Огибающая корреляционного интеграла при наличии сигнала распределена по закону Релея-Райса.
$$ \tag{1.4.17, стр. 86}
    W_1(Y) = \frac{Y}{\sigma_Y^2}\exp\left(-\frac{Y^2 + m_Y^2}{2\sigma_Y^2}\right)I_0\left(\frac{m_YY}{\sigma_Y^2}\right)
$$
где $m_y = E_c$, $\sigma_Y^2 = N_0E_c$. Тогда вероятность обнаружения и пропуска сигнала будет
$$ \tag{1.4.19, стр. 86}
    F = \exp\left(-\frac{z_0^2}{2E_c^2}\frac{E_c}{N_0}\right)
$$
$$ \tag{1.4.29, стр. 87}
    D=Q_1\left(\frac{E_c}{\sqrt{N_0E_c}},\frac{z_0}{\sqrt{N_0E_c}}\right)
$$
Заданная вероятность ложной тревоги будет определяться порогом $z_0 = E_c\sqrt{-2\frac{N_0}{E_c}lnF}$

---

## Решающее правило при приеме сигнала со случайной амплитудой
Амплитуда полагается распределенной по закону Релея
$$ \tag{1.4.22, стр 88}
    W(Y_0) = \frac{U_0}{\sigma_U^2}exp\left(-\frac{U_0^2}{2\sigma_U^2}\right)
$$
Среднее значение $\overline{U}_0^2 = 2\sigma_U^2$. После усреднения по неизвестной амплитуде, вид достаточной статистики будет тот же, что и при случайной начальной фазе.

---

## Вероятность обнаружения и ложной тревоги для сигнала со случайной начальной фазой и амплитудой
Огибающая корреляционного интеграла при наличии сигнала распределена по закону Релея.
$$ \tag{1.4.23, стр. 90}
W_1(Y) = \frac{Y}{\sigma_Y^2\left(1 + m_Y^2\sigma_U^2/\sigma_Y^2\right)}exp\left(\frac{Y^2}{2\sigma_Y^2\left(1 + m_Y^2\sigma_U^2/\sigma_Y^2\right)}\right)
$$
При отсутствии сигнала огибающая будет $(1.4.18)$, где $m_Y = E_c$, $\sigma_Y^2 = N_0E_c$, $\sigma_U$ - параметр закона распределения амплитуды.
Тогда вероятность правильного обнаружения
$$ \tag{1.4.24, стр. 90}
    D = \exp\left( -\frac{z_0^2}{2E_c^2}\frac{E_c}{N_0}\frac{1}{\left(1 + \overline{E}_c/N_0\right)} \right)
$$
где средняя энергия $\overline{E}_c = E_c\overline{U}_0^2$, а $\overline{U}_0 = \sqrt{2}\sigma_U$.

Тогда заданная вероятность ложной тревоги обеспечивается при пороге
$$
z_0 = E_c\sqrt{-2\frac{N_0}{E_c}lnF}
$$
$$ \tag{1.4.25, стр. 91}
    D = F^{\frac{1}{1 + \overline{q}}}
$$
